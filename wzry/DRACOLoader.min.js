"use strict";THREE.DRACOLoader=function(e){this.timeLoaded=0,this.manager=e||THREE.DefaultLoadingManager,this.materials=null,this.verbosity=0,this.attributeOptions={},this.drawMode=THREE.TrianglesDrawMode,this.nativeAttributeMap={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"}},THREE.DRACOLoader.prototype={constructor:THREE.DRACOLoader,load:function(e,t,r,o){var i=this,n=new THREE.FileLoader(i.manager);n.setPath(this.path),n.setResponseType("arraybuffer"),n.load(e,function(e){i.decodeDracoFile(e,t)},r,o)},setPath:function(e){return this.path=e,this},setVerbosity:function(e){return this.verbosity=e,this},setDrawMode:function(e){return this.drawMode=e,this},setSkipDequantization:function(e,t){var r=!0;return void 0!==t&&(r=t),this.getAttributeOptions(e).skipDequantization=r,this},decodeDracoFile:function(t,r,o,i){var n=this;THREE.DRACOLoader.getDecoderModule().then(function(e){n.decodeDracoFileInternal(t,e.decoder,r,o,i)})},decodeDracoFileInternal:function(e,t,r,o,i){var n=new t.DecoderBuffer;n.Init(new Int8Array(e),e.byteLength);var a=new t.Decoder,d=a.GetEncodedGeometryType(n);if(d==t.TRIANGULAR_MESH)0<this.verbosity&&console.log("Loaded a mesh.");else{if(d!=t.POINT_CLOUD){var s="THREE.DRACOLoader: Unknown geometry type.";throw console.error(s),new Error(s)}0<this.verbosity&&console.log("Loaded a point cloud.")}r(this.convertDracoGeometryTo3JS(t,a,d,n,o,i))},addAttributeToGeometry:function(e,t,r,o,i,n,a,d){if(0===n.ptr){var s="THREE.DRACOLoader: No attribute "+o;throw console.error(s),new Error(s)}var u,c,l=n.num_components(),A=r.num_points()*l;switch(i){case Float32Array:u=new e.DracoFloat32Array,t.GetAttributeFloatForAllPoints(r,n,u),d[o]=new Float32Array(A),c=THREE.Float32BufferAttribute;break;case Int8Array:u=new e.DracoInt8Array,t.GetAttributeInt8ForAllPoints(r,n,u),d[o]=new Int8Array(A),c=THREE.Int8BufferAttribute;break;case Int16Array:u=new e.DracoInt16Array,t.GetAttributeInt16ForAllPoints(r,n,u),d[o]=new Int16Array(A),c=THREE.Int16BufferAttribute;break;case Int32Array:u=new e.DracoInt32Array,t.GetAttributeInt32ForAllPoints(r,n,u),d[o]=new Int32Array(A),c=THREE.Int32BufferAttribute;break;case Uint8Array:u=new e.DracoUInt8Array,t.GetAttributeUInt8ForAllPoints(r,n,u),d[o]=new Uint8Array(A),c=THREE.Uint8BufferAttribute;break;case Uint16Array:u=new e.DracoUInt16Array,t.GetAttributeUInt16ForAllPoints(r,n,u),d[o]=new Uint16Array(A),c=THREE.Uint16BufferAttribute;break;case Uint32Array:u=new e.DracoUInt32Array,t.GetAttributeUInt32ForAllPoints(r,n,u),d[o]=new Uint32Array(A),c=THREE.Uint32BufferAttribute;break;default:s="THREE.DRACOLoader: Unexpected attribute type.";throw console.error(s),new Error(s)}for(var E=0;E<A;E++)d[o][E]=u.GetValue(E);a.addAttribute(o,new c(d[o],l)),e.destroy(u)},convertDracoGeometryTo3JS:function(e,t,r,o,i,n){var a,d;!0===this.getAttributeOptions("position").skipDequantization&&t.SkipAttributeTransform(e.POSITION);var s=performance.now();if(!(d=r===e.TRIANGULAR_MESH?(a=new e.Mesh,t.DecodeBufferToMesh(o,a)):(a=new e.PointCloud,t.DecodeBufferToPointCloud(o,a))).ok()||0==a.ptr){var u="THREE.DRACOLoader: Decoding failed: ";throw u+=d.error_msg(),console.error(u),e.destroy(t),e.destroy(a),new Error(u)}var c,l=performance.now();e.destroy(o),r==e.TRIANGULAR_MESH?(c=a.num_faces(),0<this.verbosity&&console.log("Number of faces loaded: "+c.toString())):c=0;var A=a.num_points(),E=a.num_attributes();0<this.verbosity&&(console.log("Number of points loaded: "+A.toString()),console.log("Number of attributes loaded: "+E.toString()));var f=t.GetAttributeId(a,e.POSITION);if(-1==f){u="THREE.DRACOLoader: No position attribute found.";throw console.error(u),e.destroy(t),e.destroy(a),new Error(u)}var R=t.GetAttribute(a,f),y={},b=new THREE.BufferGeometry;if(i)for(var D in i){var T=n[D],m=i[D],p=t.GetAttributeByUniqueId(a,m);this.addAttributeToGeometry(e,t,a,D,T,p,b,y)}else for(var D in this.nativeAttributeMap){var h=t.GetAttributeId(a,e[this.nativeAttributeMap[D]]);if(-1!==h){0<this.verbosity&&console.log("Loaded "+D+" attribute.");p=t.GetAttribute(a,h);this.addAttributeToGeometry(e,t,a,D,Float32Array,p,b,y)}}if(r==e.TRIANGULAR_MESH)if(this.drawMode===THREE.TriangleStripDrawMode){var w=new e.DracoInt32Array;t.GetTriangleStripsFromMesh(a,w);y.indices=new Uint32Array(w.size());for(var v=0;v<w.size();++v)y.indices[v]=w.GetValue(v);e.destroy(w)}else{var H=3*c;y.indices=new Uint32Array(H);var O=new e.DracoInt32Array;for(v=0;v<c;++v){t.GetFaceFromMesh(a,v,O);var L=3*v;y.indices[L]=O.GetValue(0),y.indices[L+1]=O.GetValue(1),y.indices[L+2]=O.GetValue(2)}e.destroy(O)}b.drawMode=this.drawMode,r==e.TRIANGULAR_MESH&&b.setIndex(new(65535<y.indices.length?THREE.Uint32BufferAttribute:THREE.Uint16BufferAttribute)(y.indices,1));var I=new e.AttributeQuantizationTransform;if(I.InitFromAttribute(R)){b.attributes.position.isQuantized=!0,b.attributes.position.maxRange=I.range(),b.attributes.position.numQuantizationBits=I.quantization_bits(),b.attributes.position.minValues=new Float32Array(3);for(v=0;v<3;++v)b.attributes.position.minValues[v]=I.min_value(v)}return e.destroy(I),e.destroy(t),e.destroy(a),this.decode_time=l-s,this.import_time=performance.now()-l,0<this.verbosity&&(console.log("Decode time: "+this.decode_time),console.log("Import time: "+this.import_time)),b},isVersionSupported:function(t,r){THREE.DRACOLoader.getDecoderModule().then(function(e){r(e.decoder.isVersionSupported(t))})},getAttributeOptions:function(e){return void 0===this.attributeOptions[e]&&(this.attributeOptions[e]={}),this.attributeOptions[e]}},THREE.DRACOLoader.decoderPath="./",THREE.DRACOLoader.decoderConfig={},THREE.DRACOLoader.decoderModulePromise=null,THREE.DRACOLoader.setDecoderPath=function(e){THREE.DRACOLoader.decoderPath=e},THREE.DRACOLoader.setDecoderConfig=function(e){var t=THREE.DRACOLoader.decoderConfig.wasmBinary;THREE.DRACOLoader.decoderConfig=e||{},THREE.DRACOLoader.releaseDecoderModule(),t&&(THREE.DRACOLoader.decoderConfig.wasmBinary=t)},THREE.DRACOLoader.releaseDecoderModule=function(){THREE.DRACOLoader.decoderModulePromise=null},THREE.DRACOLoader.getDecoderModule=function(){var r=this,e=THREE.DRACOLoader.decoderPath,o=THREE.DRACOLoader.decoderConfig,t=THREE.DRACOLoader.decoderModulePromise;return t||(t=(t="undefined"!=typeof DracoDecoderModule?Promise.resolve():"object"!=typeof WebAssembly||"js"===o.type?THREE.DRACOLoader._loadScript(e+"draco_decoder.js"):(o.wasmBinaryFile=e+"draco_decoder.wasm",THREE.DRACOLoader._loadScript(e+"draco_wasm_wrapper.js").then(function(){return THREE.DRACOLoader._loadArrayBuffer(o.wasmBinaryFile)}).then(function(e){o.wasmBinary=e}))).then(function(){return new Promise(function(t){o.onModuleLoaded=function(e){r.timeLoaded=performance.now(),t({decoder:e})},DracoDecoderModule(o)})}),THREE.DRACOLoader.decoderModulePromise=t)},THREE.DRACOLoader._loadScript=function(e){var t=document.getElementById("decoder_script");null!==t&&t.parentNode.removeChild(t);var r=document.getElementsByTagName("head")[0],o=document.createElement("script");return o.id="decoder_script",o.type="text/javascript",o.src=e,new Promise(function(e){o.onload=e,r.appendChild(o)})},THREE.DRACOLoader._loadArrayBuffer=function(r){var o=new THREE.FileLoader;return o.setResponseType("arraybuffer"),new Promise(function(e,t){o.load(r,e,void 0,t)})};